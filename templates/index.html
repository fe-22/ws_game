<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>ü™®üìÑ‚úÇÔ∏è Pedra, Papel e Tesoura Online</title>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            text-align: center;
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            color: #fff;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        h1 { font-size: 2.5rem; margin-bottom: 10px; }

        .card {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            margin: auto;
        }

        input, button, select {
            font-size: 1rem;
            padding: 10px;
            border-radius: 8px;
            border: none;
            margin: 8px;
        }

        button {
            background-color: #00aaff;
            color: white;
            cursor: pointer;
            transition: 0.3s;
        }

        button:hover { background-color: #0077cc; }

        #resultado {
            margin-top: 15px;
            font-size: 1.2rem;
            color: #ffcc00;
        }

        .convite { margin-top: 20px; }

        footer {
            background: rgba(0, 0, 0, 0.3);
            color: #ccc;
            text-align: center;
            padding: 10px;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        footer a {
            color: #00ffcc;
            text-decoration: none;
            transition: 0.3s;
        }

        footer a:hover { color: #ffffff; }
    </style>
</head>
<body>

<div class="card">
    <h1>ü™®üìÑ‚úÇÔ∏è Pedra, Papel e Tesoura</h1>

    <div id="setup">
        <input type="text" id="idJogo" placeholder="Nome do jogo">
        <input type="number" id="jogadores" min="2" max="10" value="2">
        <button onclick="criarJogo()">üéÆ Criar Jogo</button>
    </div>

    <div id="convite" class="convite" style="display: none;">
        <p>Copie e envie o link abaixo:</p>
        <p id="linkConvite" style="word-wrap: break-word; color:#00ffcc;"></p>
        <button id="btnWhatsapp">üì± Convidar via WhatsApp</button>
    </div>

    <div id="jogo" style="display: none;">
        <h2>Fa√ßa sua jogada:</h2>
        <button onclick="jogar('pedra')">ü™® Pedra</button>
        <button onclick="jogar('papel')">üìÑ Papel</button>
        <button onclick="jogar('tesoura')">‚úÇÔ∏è Tesoura</button>
        <div id="resultado"></div>
        <div id="rodada">Rodada: 1</div>
        <div id="placar"></div>
        <button onclick="encerrarJogo()">üõë Encerrar Jogo</button>
    </div>
</div>

<footer>
    Desenvolvido por <strong>Fthec</strong> üíª | 
    <a href="https://home-page-76ks.onrender.com/" target="_blank">Site Oficial</a>
</footer>

<script>
    let idJogo = "";
    let jogador = Math.floor(Math.random() * 10000);

    async function criarJogo() {
        idJogo = document.getElementById("idJogo").value.trim() || "jogo" + Math.floor(Math.random() * 1000);
        const jogadores_necessarios = document.getElementById("jogadores").value;

        const res = await fetch("/criar_jogo", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ id_jogo: idJogo, jogadores_necessarios })
        });
        const data = await res.json();

        const link = data.link_convite;
        document.getElementById("linkConvite").innerText = link;
        document.getElementById("btnWhatsapp").onclick = () => {
            const msg = encodeURIComponent(`üéÆ Venha jogar Pedra, Papel e Tesoura comigo! Acesse: ${link}`);
            window.open(`https://wa.me/?text=${msg}`, "_blank");
        };

        document.getElementById("convite").style.display = "block";
        document.getElementById("jogo").style.display = "block";
    }

    async function jogar(escolha) {
        const res = await fetch(`/jogar/${idJogo}/${jogador}`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ escolha })
        });
        const data = await res.json();

        if (data.mensagem) {
            document.getElementById("resultado").innerText = data.mensagem;
        } else {
            document.getElementById("resultado").innerText = "Resultado: " + data.resultado_rodada;
            document.getElementById("placar").innerText = "Placar: " + JSON.stringify(data.placar);
            document.getElementById("rodada").innerText = "Rodada: " + data.rodada;
        }
    }

    async function encerrarJogo() {
        const res = await fetch(`/encerrar_jogo/${idJogo}`, { method: "POST" });
        const data = await res.json();
        alert("Jogo encerrado! Placar final: " + JSON.stringify(data.placar_final));
        document.getElementById("resultado").innerText = "";
        document.getElementById("placar").innerText = "";
        document.getElementById("rodada").innerText = "";
        document.getElementById("jogo").style.display = "none";
        document.getElementById("convite").style.display = "none";
    }
</script>

</body>
</html>
